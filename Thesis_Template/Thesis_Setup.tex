% !TEX root = main.tex

%############################################
%page layout
%############################################

%European book class, index and lists in toc, two sided layout, chapters start on both sides, 12 pt font
\documentclass[idxtotoc, bibtotoc,listof=totoc , twoside, openany,12pt]{scrbook} 

% 1.5 line spacing and fix for arrays and tables.
%\usepackage[onehalfspacing]{setspace}
%\setdisplayskipstretch{}
%\renewcommand{\arraystretch}{0.75}

%scalable font similar to cm
\usepackage{lmodern} 
 
%sans serif font
%\renewcommand{\familydefault}{\sfdefault} 
 
%define margins and dimensions
\usepackage[a4paper,includehead,bindingoffset=1cm,inner=2.0cm,outer = 2.5cm ,top=2cm,bottom=2.5cm]{geometry}   
 
%package for conditional use of \newpage
\usepackage{needspace}
 


%############################################
%create header and footer 
%############################################ 
 
%the package
\usepackage[automark]{scrlayer-scrpage}

%clear predefined header and footer
\pagestyle{scrheadings} \clearscrheadfoot 

%line below header
\setheadsepline[\textwidth]{0.5pt} 

%inner header [plain]{regualr}
\ihead[]{\headmark} 

%outer header [plain]{regualr}
\ohead[]{\thepage} 









%############################################
%empty pages and title pages
%############################################ 



%text on empty pages
\newcommand*{\blankpage}{%
	\par\vspace*{\fill}%
	{\centering \textcolor{black!80}{This page intentionally left blank.}\par}%the text to be displayed
	\vspace{\fill}%
}
\makeatletter
\renewcommand*{\cleardoubleoddstandardpage}{%
	\clearpage
	\if@twoside
	\ifodd\c@page
	\else
	\blankpage
	\thispagestyle{empty}%
	\newpage
	\if@twocolumn\hbox{}\newpage\fi
	\fi
	\fi
}
\makeatother


%part command that allows for text on the same page
%\PartWithText{title}{text}
\newcommand{\PartWithText}[2]{
\setpartpreamble[u,c][0.9 \textwidth]{
	\vspace{1cm}
	
	\noindent
	#2
	
}
\part{#1}
}













%############################################
%adjust headings
%############################################
\usepackage[noindentafter,nobottomtitles*]{titlesec}
\renewcommand{\bottomtitlespace}{48pt}

%\titleformat{\heading}[form]{format}{label}{spacing to label}{}[after code]
%\titlespacing{\heading}{left}{above}{below}

%chapter
\titleformat{\chapter}[display] 
{\ifthispageodd{\filleft}{}\huge\bfseries \fontfamily{bch} \selectfont}
{\ifthispageodd
	{\makebox[\linewidth][r]{\raisebox{115pt}[0pt][0pt]{\textcolor{gray!35}{\fontsize{80pt}{95pt}\rmfamily\selectfont\thechapter}}} }
	{\makebox[\linewidth][l]{\raisebox{115pt}[0pt][0pt]{\textcolor{gray!35}{\fontsize{80pt}{95pt}\rmfamily\selectfont\thechapter}}}  }
}  
{-12ex} 
{}  
[\vspace{0.5ex}\titlerule]

%chapters without number
\titleformat{name=\chapter,numberless}[display]
{\ifthispageodd{\filleft}{}\huge\bfseries\fontfamily{bch} \selectfont} 
{}  
{-16.8ex}  
{}  
[\vspace{1ex}\titlerule]

\titlespacing{\chapter}{0pt}{3cm}{10pt}[0pt]


\titleformat{\section}[block]{\bfseries\Large \fontfamily{bch} \selectfont}{\thesection}{0.7em}{}
\titlespacing{\section}{0pt}{28pt}{10pt}                  		


\titleformat{\subsection}[block]{\bfseries\large\fontfamily{bch} \selectfont}{\thesubsection}{0.7em}{}\titlespacing{\subsection}{0pt}{20pt}{7pt}                  		

\titleformat{\subsubsection}[block]{\bfseries\fontfamily{bch} \selectfont}{\thesubsubsection}{0pt}{}  \titlespacing{\subsubsection}{0pt}{10pt}{5pt}                  	





%intro text for chapters
\newcommand{\ChapterStart}[1]{{\small \sffamily \selectfont #1 }\\
	\rule{\textwidth}{0.5pt}}














%############################################
%language settings
%############################################

%language 
\usepackage[english]{babel} 

%special characters
\usepackage[utf8]{inputenc}	
\usepackage[T1]{fontenc}

%optimization of micro spaces 	
\usepackage{microtype}	











%############################################
%colors and images
%############################################

%importing images
\usepackage{graphicx} 

%more colors
\usepackage[dvipsnames]{xcolor} 

%caption improvements
\usepackage[font=footnotesize,format=plain, bf]{caption} 

%more than one image in figure environments
\usepackage[font=footnotesize]{subcaption} 

%wrap text around figures
\usepackage{wrapfig} 

%colored frames in equations
\usepackage{empheq}

%tikz/pgf package to program graphics 
\usepackage{tikz} 

%some useful libraries. Babel to fix problems with babel package
\usetikzlibrary{positioning, calc, intersections, cd, babel} 
\usepackage{tikz-3dplot}










%############################################
%tables
%############################################

%colors in tables
\usepackage{colortbl} 

%long tables that allow page breaks
\usepackage{longtable} 

%join or separate cells 
\usepackage{paralist} 

%as above
\usepackage{multirow} 








%############################################
%mathematics
%############################################

%standard maths
\usepackage{amsmath,amsthm,amsfonts,amssymb,mathtools} 

%\mathbbm{1} for unity operator
\usepackage{bbm} 

%\nicefrac{}{} and units
\usepackage{units} 

%crossing out in formulas
\usepackage{cancel} 

%shrinking formula in gather to fit page
\usepackage{resizegather} 

%tensor indices
\usepackage{tensor} 

%fixes space around \ldots
\usepackage{ellipsis}

%frames for theorems
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}


%allows to redefine margins dynamically
\usepackage{scrextend} 






%page breakes in multiline formulas
\allowdisplaybreaks 

%bold mathematics
\makeatletter
\g@addto@macro\bfseries{\boldmath}
\makeatother



%definition of the usual theorem environments

%\newtheoremstyle{name}{space above}{space below}{content format}{indent space}{caption format}{after caption}{space below caption}{}

\newtheoremstyle{plain}{\topsep}{\topsep}{\itshape}{}{\bf}{.\ \\}{.5ex}{}
\newtheoremstyle{definition}{\topsep}{\topsep}{}{}{\bf}{.\ \\}{.5ex}{}
\newtheoremstyle{info}{\topsep}{\topsep}{}{}{\bfseries \normalsize }{.\ \\}{.5ex}{}


\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{lemm}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}

%variable theorem name using \renewcommand{\VarThmName}{new name}
\newcommand{\VarThmName}{VarThm} 
\newtheorem{VarThm}[thm]{\VarThmName}
\newtheorem{VarLemm}[thm]{\VarThmName}
\newtheorem{VarCor}[thm]{\VarThmName}

\theoremstyle{definition}
\newtheorem{deff}[thm]{Definition}
\newtheorem{prf}[thm]{Proof}
\newtheorem{VarDef}[thm]{\VarThmName}

\theoremstyle{info}
\newtheorem{rem}[thm]{Remark}
\newtheorem{exm}[thm]{Example}

%frames for theorems

\newenvironment{framedef}{
	\begin{tcolorbox}[enhanced, colback = gray!50!blue!15, borderline = {0.5pt}{0mm}{gray!90!blue}, leftrule = 4pt, toprule = 0pt, bottomrule = 0pt, rightrule = 0 pt, beforeafter skip= 1em, breakable]
		
	\needspace{0.5cm}	
	
	}{\end{tcolorbox} }


\newenvironment{framethm}{
	\begin{tcolorbox}[enhanced, colback = gray!50!blue!25, borderline = {0.5pt}{0mm}{gray!90!blue},leftrule = 5pt, toprule = 0pt, bottomrule = 0pt, rightrule = 0 pt, beforeafter skip= 1em, breakable]
	
	\needspace{0.5cm}
		
	}{\end{tcolorbox}	}



\newenvironment{framelemm}{
	\begin{tcolorbox}[enhanced, colback = gray!50!blue!10, borderline = {0.5pt}{0mm}{gray!90!blue}, leftrule = 2pt, toprule = 0pt, bottomrule = 0pt, rightrule = 0 pt ,beforeafter skip= 1em, breakable]
		
	\needspace{0.5cm}
		
	}{\end{tcolorbox}	}



\newenvironment{framecor}{
	\begin{tcolorbox}[enhanced, colback = gray!50!blue!6, borderline = {0.5pt}{0mm}{gray!90!blue}, leftrule = 2pt, toprule = 0pt, bottomrule = 0pt, rightrule = 0 pt ,beforeafter skip= 1em, breakable]
		
	\needspace{0.5cm}	
		
	}{\end{tcolorbox}	}


\newenvironment{framerem}{
	\begin{tcolorbox}[enhanced, colback = gray!50!blue!0, borderline = {0.5pt}{0mm}{gray!90!blue},leftrule = 0pt, toprule = 0pt, bottomrule = 0pt, rightrule = 0 pt , beforeafter skip= 1em, breakable]
	
	\needspace{0.5cm}
	\small
		
	}{\end{tcolorbox}	}

\newenvironment{frameexm}{
	\begin{tcolorbox}[enhanced, colback = gray!50!blue!0, borderline = {0.5pt}{0mm}{gray!90!blue},leftrule = 0pt, toprule = 0pt, bottomrule = 0pt, rightrule = 0 pt , beforeafter skip= 1em, breakable]
		
		\needspace{0.5cm}
		\small
		
	}{\end{tcolorbox}	}

%\newenvironment{framerem}{\vspace{-10pt}\begin{addmargin}[12pt]{12pt}\footnotesize}{\end{addmargin} \vspace{10pt}}


\newenvironment{frameproof}[1][false]
{\vspace{-10pt}\begin{addmargin}[12pt]{12pt}}{\end{addmargin} \vspace{10pt}}
















%############################################
%directories and links
%############################################

%literature with Biblatex
\usepackage[backend=bibtex, sorting = nyt, style=alphabetic]{biblatex} 

%index package
\usepackage{imakeidx}

%literature file
\addbibresource{Literatur.bib} 

%fix for too long entries
\makeatletter
\def\@idxitem{\par\hangindent 2ex}
\makeatother

 %create index
\makeindex[intoc,options= -s index_style.ist]

%links in pdf
\usepackage[colorlinks=true, linkcolor=Cerulean!75!black, citecolor=green!60!black, linktocpage=true]{hyperref} 








%############################################
%useful short commands
%############################################	
	
%notation quantum mechanics
\newcommand{\bra}[1]{\langle #1 |}
\newcommand{\ket}[1]{| #1 \rangle}
\newcommand{\braket}[1]{\langle #1 \rangle}
\newcommand{\Bra}[1]{\left\langle #1 \right|}
\newcommand{\Ket}[1]{\left| #1 \right\rangle}
\newcommand{\Braket}[1]{\left\langle #1 \right\rangle}

%\boxed with additional horizontal space
\newcommand{\widebox}[1]{\boxed{\hspace{1em}#1\hspace{1em}}}

%tensor indices
\newcommand{\tens}[1]{\indices{#1}}


%set front matter {title}{text}
\newcommand{\FrontMatter}[2]{

\frontmatter
\newgeometry{a4paper,includeheadfoot,inner=2.5cm,outer = 2.5cm ,top=1cm,bottom=1cm}	
\include{title_page}
\restoregeometry
\setcounter{page}{0}
\cleardoublepage




\chapter*{#1}
\addcontentsline{toc}{chapter}{#1}
#2




\cleardoublepage

\tableofcontents
\mainmatter


}




\newcommand{\FrontNoPreface}{
	
	\frontmatter
	\newgeometry{a4paper,includeheadfoot,inner=2.5cm,outer = 2.5cm ,top=1cm,bottom=1cm}	
	\include{title_page}
	\restoregeometry
	\setcounter{page}{0}
	\tableofcontents
	\mainmatter
	
	
}


